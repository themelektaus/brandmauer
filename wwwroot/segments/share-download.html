<h2><i class="fas fa-paperclip"></i>Share</h2>
<div id="form">
    <div class="file-list"><!--file-list--></div>
    <pre id="text" type="text" readonly><!--text--></pre>
</div>
<div style="display: flex; flex-direction: column; align-items: center; gap: 1rem; margin-bottom: 1rem; ">
    <a id="clipboard1"><i class="fas fa-paperclip"></i>Copy Link</a>
    <a id="clipboard2"
       class="display-none"
       style="font-size: .8em; filter: brightness(.75); ">Copy Unprotected Link (not recommended)</a>
</div>
<a href="share">Create another Share</a>
<style>
    h2 {
        font-size: 2em;
    }
    h2 > i {
        color: #f90;
        margin-right: .375em;
    }
    a.disabled {
        color: #6f6;
        pointer-events: none;
    }
    #form {
        width: 25em;
        max-width: 70vw;
        display: flex;
        flex-direction: column;
        flex: 0;
        gap: 1rem;
        margin: 1rem 0;
    }
    #text {
        padding: .5rem;
        line-height: 1.5;
        background-color: var(--menu-item__background-color);
        box-sizing: border-box;
        width: 100%;
        font-family: inherit;
        font-size: inherit;
    }
    #buttons {
        display: flex;
        gap: .5rem;
    }
    #new {
        background-color: #263;
    }
</style>
<script>
    addEventListener(`load`, () =>
    {
        const $text = q(`#text`)
        if (!$text.innerHTML)
        $text.remove()
        
        const $clipboard1 = q(`#clipboard1`)
        const $clipboard2 = q(`#clipboard2`)
        
        const url = location.href.split('$')
        if (url.length > 1 && url[1])
        {
            const icon = `<i class="fas fa-paperclip"></i>`
            $clipboard1.innerHTML = `${icon}Copy Protected Link`
            $clipboard2.setClass(`display-none`, false)
        }
        
        const setEnabled = enabled =>
        {
            $clipboard1.setClass(`disabled`, !enabled)
            $clipboard2.setClass(`disabled`, !enabled)
            $new.disabled = !enabled
        }
        
        const copyToClipboard = async ($target, value) =>
        {
            $target.setClass(`disabled`, true)
            await navigator.clipboard.writeText(value)
            const html = $target.innerHTML
            $target.innerHTML = `<i class="fas fa-check"></i>Copied`
            await new Promise(x => setTimeout(x, 1000))
            $target.innerHTML = html
            $target.setClass(`disabled`, false)
        }
        
        $clipboard1.addEventListener(`click`, async e =>
        {
            await copyToClipboard(e.target, location.href.split('$')[0])
        })
        
        $clipboard2.addEventListener(`click`, async e =>
        {
            await copyToClipboard(e.target, location.href)
        })
        
        qAll(`[data-url]`).forEach($ =>
        {
            $.addEventListener(`click`, async () =>
            {
                $.disabled = true
                location.href = $.dataset.url
                await new Promise(x => setTimeout(x, 1000))
                $.disabled = false
            })
        })
    })
</script>